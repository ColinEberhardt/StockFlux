"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){angular.module("OpenFinD3FC",["ngAnimate","openfin.parent","openfin.main","openfin.showcase","openfin.toolbar","openfin.icon","openfin.search","openfin.favourites","openfin.sidebar","openfin.filters","openfin.star","openfin.tearout","openfin.minichart","openfin.scroll"]),angular.module("openfin.main",["openfin.currentWindow"]),angular.module("openfin.showcase",["openfin.selection","openfin.quandl"]),angular.module("openfin.toolbar",["openfin.currentWindow"]),angular.module("openfin.icon",[]),angular.module("openfin.search",["openfin.quandl","openfin.selection","openfin.currentWindow"]),angular.module("openfin.favourites",["openfin.quandl","openfin.selection","openfin.currentWindow"]),angular.module("openfin.sidebar",[]),angular.module("openfin.filters",[]),angular.module("openfin.star",["openfin.selection"]),angular.module("openfin.tearout",["openfin.geometry","openfin.hover","openfin.currentWindow"]),angular.module("openfin.minichart",["openfin.quandl"]),angular.module("openfin.store",[]),angular.module("openfin.parent",["openfin.window"]),angular.module("openfin.currentWindow",[]),angular.module("openfin.window",[]),angular.module("openfin.scroll",[])}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.$scope=b,this.setup()}return _createClass(a,[{key:"setup",value:function(){function a(a){return arguments.length?void(d[c+e]=a):d[c+e]}function b(a){return arguments.length?void(d[c+f]=a):d[c+f]}var c=this.$scope.name,d={},e="_active",f="_hovered";d[c+e]=!1,d[c+f]=!1,this.urls={inactive:c,hover:c+"_hover",active:c+"_active"},this.icon={active:a,hovered:b}}},{key:"enter",value:function(){this.icon.hovered(!0)}},{key:"leave",value:function(){this.icon.hovered(!1),this.icon.active(!1)}},{key:"url",value:function(){return this.icon.active()?this.urls.active:this.icon.hovered()?this.urls.hover:this.urls.inactive}},{key:"mouseDown",value:function(a,b){0===a.button&&this.icon.active(!0)}},{key:"click",value:function(a,b){0===a.button&&(this.icon.active(!0),this.$scope.iconClick(),this.icon.active(!1),this.icon.hovered(!1))}}]),a}();a.$inject=["$scope"],angular.module("openfin.icon").controller("IconCtrl",a)}(),function(){angular.module("openfin.icon").directive("icon",[function(){return{restrict:"E",templateUrl:"icon/icon.html",scope:{name:"@",iconClick:"&"},controller:"IconCtrl",controllerAs:"iconCtrl"}}])}(),function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$timeout=b,this.currentWindowService=c}return _createClass(a,[{key:"isCompact",value:function(){return this.currentWindowService.compact}}]),a}();a.$inject=["$timeout","currentWindowService"],angular.module("openfin.main").controller("MainCtrl",a)}(),function(){angular.module("openfin.main").directive("main",[function(){return{restrict:"E",templateUrl:"main/main.html",controller:"MainCtrl",controllerAs:"mainCtrl"}}])}(),function(){function a(){return{autoShow:!0,minWidth:918,minHeight:510,defaultWidth:1280,defaultHeight:720,frame:!1,url:"index.html"}}var b=function c(b,d,e){_classCallCheck(this,c),e.ready(function(){var c,f,g=d.getPreviousOpenWindowNames(),h=g.length;if(0!==h)for(c=0;h>c;c++){var i=a();i.name=g[c],e.createMainWindow(i)}else e.createMainWindow(a());b.$on("updateFavourites",function(a,b){var d=new Event("updateFavourites");d.stock=b;var g=e.getWindows();for(c=0,f=g.length;f>c;c++)g[c].getNativeWindow().dispatchEvent(d)})})};b.$inject=["$scope","storeService","windowCreationService"],angular.module("openfin.parent").controller("ParentCtrl",b)}(),function(){angular.module("OpenFinD3FCParent",["openfin.parent"]),angular.module("openfin.parent",["openfin.store","openfin.window"]),angular.module("openfin.store",[]),angular.module("openfin.currentWindow",[]),angular.module("openfin.window",["openfin.store"])}(),function(a){angular.module("openfin.currentWindow").factory("currentWindowService",["$rootScope",function(b){function c(){return a.desktop.Window.getCurrent()}function d(b){a.desktop.main(b)}return window.addEventListener("updateFavourites",function(a){b.$broadcast("updateFavourites",a.stock)}),{getCurrentWindow:c,ready:d}}])}(fin),function(){function a(){return moment().subtract(28,"days")}function b(a,b,c){var d=a.dataset_code,e={name:a.name,code:d,favourite:!1,query:b};c(e)}function c(b){for(var c=b.datasets,d=[],e=0,f=c.length;f>e;e++)moment(c[e].newest_available_date)>a()&&d.push(c[e]);return{datasets:d}}function d(a){var b=a.dataset,c=b.data,d=[],f=0,g=c.length;for(f;g>f;f++)d.push(e(c[f]));a.stockData={startDate:b.start_date,endDate:b.end_date,data:d}}function e(a){return{date:a[h],open:a[i],high:a[j],low:a[k],close:a[l],volume:a[m]}}var f="kM9Z9aEULVDD7svZ4A8B",g="api_key="+f,h=0,i=1,j=2,k=3,l=4,m=5,n="https://www.quandl.com/api/v3/",o="datasets/WIKI/",p=function(){function e(a){_classCallCheck(this,e),this.$resource=a}return _createClass(e,[{key:"search",value:function(a,c,d){this.stockSearch().get({query:a},function(e){e.datasets.map(function(d){b(d,a,c)}),0===e.datasets.length&&d()})}},{key:"getMeta",value:function(a,c){this.stockMetadata().get({stock_code:a},function(d){b(d.dataset,a,c)})}},{key:"stockData",value:function(){var b,c=a().format("YYYY-MM-DD");return this.$resource(n+o+":code.json?"+g+"&start_date="+c,{},{get:{method:"GET",transformResponse:function(a,c){return b=angular.fromJson(a),d(b),b},cache:!0}})}},{key:"getData",value:function(a,b){return this.stockData().get({code:a},function(c){var d={name:c.dataset.name,code:a,data:c.stockData.data};b(d)})}},{key:"stockMetadata",value:function(){return this.$resource(n+o+":stock_code/metadata.json?"+g,{},{get:{method:"GET",cache:!0}})}},{key:"stockSearch",value:function(){return this.$resource(n+"datasets.json?"+g+"&query=:query&database_code=WIKI",{},{get:{method:"GET",cache:!0,transformResponse:function(a,b){var d=angular.fromJson(a);return c(d)}}})}},{key:"apiKey",value:function(){return f}}]),e}();p.$inject=["$resource"],angular.module("openfin.quandl",["ngResource"]).service("quandlService",p)}(),function(){var a={code:"",name:""},b=function(){function b(){_classCallCheck(this,b),this._stock=a}return _createClass(b,[{key:"select",value:function(a){this._stock=a}},{key:"selectedStock",value:function(){return this._stock}},{key:"deselect",value:function(){this._stock=a}},{key:"hasSelection",value:function(){return this._stock!==a}}]),b}();b.$inject=[],angular.module("openfin.selection",[]).service("selectionService",b)}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.selectionService=b}return _createClass(a,[{key:"selectionCode",value:function(){return this.selectionService.selectedStock().code}},{key:"selectionName",value:function(){return this.selectionService.selectedStock().name}},{key:"hasSelection",value:function(){return this.selectionService.hasSelection()}}]),a}();a.$inject=["selectionService"],angular.module("openfin.showcase",["openfin.selection","openfin.quandl"]).controller("ShowcaseCtrl",a)}(),function(a){angular.module("openfin.showcase").directive("showcase",["quandlService",function(b){return{restrict:"E",templateUrl:"showcase/showcase.html",scope:{selection:"&"},link:function(c,d){var e=a.app().quandlApiKey(b.apiKey()),f=!0;c.$watch("selection()",function(a,b){""!==a&&(f&&(f=!1,e.run(d[0].children[0])),a!==b&&e.changeQuandlProduct(a))})}}}])}(sc),function(){var a={up:"arrow_up",down:"arrow_down"},b=function(){function b(a,c,d,e,f){_classCallCheck(this,b),this.currentWindowService=a,this.quandlService=c,this.selectionService=d,this.$scope=e,this.$timeout=f,this.store=null,this.stocks=[],this.update(),this._watch()}return _createClass(b,[{key:"icon",value:function(b){return b.delta<0?a.down:a.up}},{key:"selection",value:function(){return this.selectionService.selectedStock().code}},{key:"select",value:function(a){this.selectionService.select(a)}},{key:"noFavourites",value:function(){return 0===this.stocks.length}},{key:"single",value:function(){return 1===this.stocks.length?"single":""}},{key:"update",value:function(a){var b=this;this.currentWindowService.ready(function(){b.store||(b.store=window.storeService.open(window.name)),b.favourites=b.store.get();var c,d,e;for(c=0,d=b.stocks.length;d>c;c++){var f=b.stocks[c];f.index=b.stockSortFunction(f)}var g=[];for(c=0,d=b.stocks.length;d>c;c++)-1===b.favourites.indexOf(b.stocks[c].code)&&g.push(c);for(c=g.length-1,e=0;c>=e;c--)b.stocks.splice(g[c],1);var h=b.selectionService.selectedStock();if(a)if(0===b.stocks.length)a.favourite?b.selectionService.select(a):h.code===a.code&&b.selectionService.deselect();else if(h.code===a.code&&(!a.favourite||-1===b.favourites.indexOf(h.code))&&b.stocks.length>0){var i=b.stocks.filter(function(a){return a.code===b.favourites[0]})[0];b.selectionService.select(i)}b.favourites.map(function(a){-1===b.stocks.map(function(a){return a.code}).indexOf(a)&&b.quandlService.getData(a,function(a){var c,d,e,f=a.data[0];f&&(c=f.close,d=f.close-f.open,e=d/f.open*100,b.stocks.push({name:a.name,code:a.code,price:c,delta:d,percentage:Math.abs(e),favourite:!0,index:b.stockSortFunction(a)}))})})})}},{key:"stockSortFunction",value:function(a){return this.favourites.indexOf(a.code)}},{key:"_watch",value:function(){var a=this;this.$scope.$on("updateFavourites",function(b,c){a.$timeout(function(){a.update(c)})})}}]),b}();b.$inject=["currentWindowService","quandlService","selectionService","$scope","$timeout"],angular.module("openfin.favourites").controller("FavouritesCtrl",b)}(),function(){angular.module("openfin.favourites").directive("favourite",[function(){return{restrict:"E",templateUrl:"sidebars/favourites/favourite.html",scope:{stock:"=",selection:"&",select:"&",icon:"&",renderChart:"&",single:"&"}}}])}(),function(){var a=function d(a,b){_classCallCheck(this,d),this.x=a||0,this.y=b||0},b=function(){function b(c){_classCallCheck(this,b),this.origin=new a(c.left,c.top),this.extent=new a(c.width,c.height)}return _createClass(b,[{key:"top",value:function(){return this.origin.y}},{key:"left",value:function(){return this.origin.x}},{key:"bottom",value:function(){return this.top()+this.extent.y}},{key:"right",value:function(){return this.left()+this.extent.x}},{key:"corner",value:function(){return new a(this.right(),this.bottom())}},{key:"intersects",value:function(a){var b=a.origin,c=a.corner();return c.x>this.origin.x&&c.y>this.origin.y&&b.x<this.corner().x&&b.y<this.corner().y}}]),b}(),c=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"rectangle",value:function(a){return new b(a)}}]),a}();angular.module("openfin.geometry",[]).service("geometryService",c)}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.$rootScope=b,this.hoverTargets=[]}return _createClass(a,[{key:"get",value:function(){return this.hoverTargets}},{key:"add",value:function(a,b){var c={hoverArea:a,code:b};-1===this.hoverTargets.indexOf(c)&&this.hoverTargets.push(c)}},{key:"remove",value:function(a){for(var b=0,c=this.hoverTargets.length;c>b;b++)if(this.hoverTargets[b].code===a){this.hoverTargets.splice(b,1);break}}}]),a}();a.$inject=["$rootScope"],angular.module("openfin.hover",[]).service("hoverService",a)}(),function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.quandlService=b,this.$timeout=c}return _createClass(a,[{key:"renderChart",value:function(a){var b=this;this.$timeout(function(){b.quandlService.getData(a.code,function(a){var b=fc.util.innerDimensions(document.getElementById(a.code+"chart")),c=b.width,d=b.height,e=a.data;e=e.map(function(a){var b=moment(a.date);return a.date=b.toDate(),a});var f=d3.select("#"+a.code+"chart").insert("svg","div").attr("width",c).attr("height",d),g=fc.scale.dateTime().domain(fc.util.extent().fields("date")(e)).discontinuityProvider(fc.scale.discontinuity.skipWeekends()).range([0,c]),h=d3.scale.linear().domain(fc.util.extent().fields(["high","low"])(e)).range([d,0]).nice(),i=fc.series.area().y1Value(function(a){return 1e3}).y0Value(function(a){return a.close}),j=fc.series.line(),k=[].concat(e.slice(0)[0]),l=fc.series.point(),m=fc.series.multi().series([i,j,l]).xScale(g).yScale(h).mapping(function(a){switch(a){case l:return k;default:return e}});f.append("g").datum(e).call(m)})})}}]),a}();a.$inject=["quandlService","$timeout"],angular.module("openfin.minichart",["openfin.quandl"]).controller("MinichartCtrl",a)}(),function(){angular.module("openfin.minichart").directive("minichart",[function(){return{restrict:"E",templateUrl:"sidebars/favourites/minichart/minichart.html",scope:{renderChart:"&",stock:"="}}}])}(),function(a){angular.module("openfin.tearout").directive("tearable",["geometryService","hoverService","currentWindowService",function(b,c,d){return{restrict:"C",link:function(d,e,f){function g(a,b,c){var d={defaultWidth:m,defaultHeight:n,width:b,height:c,autoShow:!1,frame:!1};return a?(d.minWidth=m,d.minHeight=n,d.url="tearout.html"):(d.minWidth=918,d.minHeight=510,d.url="index.html"),d.resizable=d.maximizable=d.showTaskbarIcon=d.saveWindowState=!a,d}function h(){function e(a){return{height:a.outerHeight,width:a.outerWidth,top:a.screenY,left:a.screenX}}function f(a,b){var c=b.getBoundingClientRect();return{height:c.height,width:c.width,top:a.top+c.top,left:a.left+c.left}}function h(g){for(var h=c.get(),i=0,k=h.length;k>i;i++){var l=b.rectangle(f(e(a),h[i].hoverArea)),m=g.intersects(l);if(m){j||(j=a.storeService.open(a.name)),j.reorder(d.stock.code,h[i].code);break}}}var n=l.parentNode,o=n.parentNode,r=o.getElementsByClassName("hover-area")[0],s={x:0,y:0},t=!1,u=!1,v={};c.add(r,d.stock.code),v.setOffset=function(a,b){return s.x=a,s.y=b,v},v.setCurrentlyDragging=function(a){return t=a,v},v.moveTearoutWindow=function(a,b){var c=5,d=5,e=16;return q.moveTo(a-m+(e-s.x+d),b-(c+s.y)),v},v.displayTearoutWindow=function(){return q.show(),q.setAsForeground(),v},v.appendToOpenfinWindow=function(a,b){return b.contentWindow.document.body.appendChild(a),v},v.returnFromTearout=function(){n.appendChild(l),q.hide()},v.clearIncomingTearoutWindow=function(){return q.getNativeWindow().document.body=q.getNativeWindow().document.createElement("body"),v},v.handleMouseDown=function(a){return 0!==a.button?!1:k.classList.contains("single")?!1:void v.setCurrentlyDragging(!0).setOffset(a.offsetX,a.offsetY).moveTearoutWindow(a.screenX,a.screenY).clearIncomingTearoutWindow().appendToOpenfinWindow(l,q).displayTearoutWindow()},v.handleMouseMove=function(a){t&&v.moveTearoutWindow(a.screenX,a.screenY)},v.handleMouseUp=function(b){if(0!==b.button)return!1;if(t)if(v.setCurrentlyDragging(!1),u){j||(j=a.storeService.open(a.name)),j.remove(d.stock);var c=e(a),f=g(!1,c.width,c.height);p.createMainWindow(f,function(c){c.moveTo(b.screenX,b.screenY),a.storeService.open(c.name).add(d.stock)}),o.removeChild(r),o.removeChild(n),i(),q.close()}else v.returnFromTearout()},q.addEventListener("bounds-changing",function(){var c=q.getNativeWindow(),d=b.rectangle(e(c)),f=e(a),g=b.rectangle(f);u=!d.intersects(g),u||h(d)}),k.addEventListener("mousedown",v.handleMouseDown),document.addEventListener("mousemove",v.handleMouseMove,!0),document.addEventListener("mouseup",v.handleMouseUp,!0)}function i(){c.remove(d.stock.code)}var j,k=e[0],l=k.parentNode.parentNode,m=l.clientWidth,n=l.clientHeight,o=g(!0,m,n),p=a.windowService,q=p.createTearoutWindow(o,a.name);d.$on("$destroy",function(a){i()}),h()}}}])}(window),function(){angular.module("openfin.filters").filter("truncate",function(){return function(a){if(a){var b=a.indexOf("(");return a.slice(0,b-1)}}})}(),function(){angular.module("openfin.scroll").directive("customScrollbar",[function(){return{restrict:"C",link:function(a,b){var c="scrollPadding";b.mCustomScrollbar({callbacks:{onOverflowY:function(){b.addClass(c)},onOverflowYNone:function(){b.removeClass(c)}}})}}}])}(),function(){var a=function(){function a(b,c,d,e){_classCallCheck(this,a),this.$scope=b,this.quandlService=c,this.selectionService=d,this.currentWindowService=e,this.store=null,this.query="",this.noResults=!1,this.stocks=[],this._watch()}return _createClass(a,[{key:"selection",value:function(){return this.selectionService.selectedStock().code}},{key:"select",value:function(a){this.selectionService.select(a)}},{key:"onSearchKeyDown",value:function(a){38===a.keyCode?this.changePointer(-1):40===a.keyCode&&this.changePointer(1)}},{key:"changePointer",value:function(a){var b=this.stocks.map(function(a){return a.code}).indexOf(this.selection()),c=b+a;c=Math.max(0,Math.min(c,this.stocks.length-1)),this.stocks.length>0&&this.select(this.stocks[c])}},{key:"submit",value:function(){var a=this;this.stocks=[],this.noResults=!1,this.currentWindowService.ready(function(){a.store||(a.store=window.storeService.open(window.name));var b=a.store.get();if(a.query){var c=b.length;a.quandlService.search(a.query,function(d){var e;if(a.stocks=a.stocks.filter(function(b,c){return b.query===a.query}),d.query===a.query){a.noResults=!1;var f=!1;for(e=0;c>e;e++)d.code===b[e]&&(d.favourite=!0,a.stocks.unshift(d),f=!0);f||a.stocks.push(d)}},function(){return a.noResults=!0})}else b.map(function(b){a.quandlService.getMeta(b,function(b){b.favourite=!0,a.stocks.push(b)})})})}},{key:"_watch",value:function(){var a=this;this.$scope.$watch(function(){return a.query},function(){a.submit()}),this.$scope.$on("updateFavourites",function(b,c){if(c){var d=a.stocks.map(function(a){return a.code}).indexOf(c.code);d>-1&&(a.query?a.stocks[d].favourite=c.favourite:a.stocks.splice(d,1))}})}}]),a}();a.$inject=["$scope","quandlService","selectionService","currentWindowService"],angular.module("openfin.search").controller("SearchCtrl",a)}(),function(){angular.module("openfin.search").directive("search",[function(){return{restrict:"E",templateUrl:"sidebars/search/search.html",controller:"SearchCtrl",controllerAs:"searchCtrl"}}])}(),function(){var a={expanded:"expanded",contracted:"contracted"},b=function(){function b(){_classCallCheck(this,b),this._favouritesClass=a.expanded,this._searchClass=a.contracted,this._showSearches=!1,this._showFavourites=!0,this._searchSmall=!0}return _createClass(b,[{key:"searchClass",value:function(){return this._searchClass}},{key:"favouritesClass",value:function(){return this._favouritesClass}},{key:"showSearches",value:function(){return this._showSearches}},{key:"showFavourites",value:function(){return this._showFavourites}},{key:"searchClick",value:function(){this._searchSmall&&(this._searchSmall=!1,this._showFavourites=!1,this._searchClass=a.expanded,this._favouritesClass=a.contracted,this._showSearches=!0)}},{key:"favouritesClick",value:function(){this._searchSmall||(this._searchSmall=!0,this._searchClass=a.contracted,this._favouritesClass=a.expanded,this._showSearches=!1,this._showFavourites=!0)}}]),b}();b.$inject=[],angular.module("openfin.sidebar").controller("SidebarCtrl",b)}(),function(){angular.module("openfin.sidebar").directive("sideBar",[function(){return{restrict:"E",templateUrl:"sidebars/sidebar.html",controller:"SidebarCtrl",controllerAs:"sidebarCtrl"}}])}(),function(){var a={off:"favourite_OFF",on:"favourite_ON",offHover:"favourite_OFF_hover",onHover:"favourite_hover"},b=function(){function b(a,c){_classCallCheck(this,b),this.$scope=a,this.store=null,this.selectionService=c,this.starHovered=!1,this.check=!1}return _createClass(b,[{key:"favouriteUrl",value:function(b){return b.favourite?a.on:this.starHovered?a.onHover:b.isHovered||this.selectionService.selectedStock()===b?a.offHover:a.off}},{key:"click",value:function(a){(!this.check||confirm("Are you sure you wish to remove this stock ("+a.code+") from your favourites?"))&&(this.store||(this.store=window.storeService.open(window.name)),a.favourite?(a.favourite=!1,this.store.remove(a)):(a.favourite=!0,this.store.add(a)))}},{key:"mouseEnter",value:function(){this.starHovered=!0}},{key:"mouseLeave",value:function(){this.starHovered=!1}}]),b}();b.$inject=["$scope","selectionService"],angular.module("openfin.star").controller("StarCtrl",b)}(),function(){angular.module("openfin.star").directive("star",[function(){return{restrict:"E",templateUrl:"sidebars/star/star.html",scope:{starClick:"&",favouriteUrl:"&",mouseLeave:"&",mouseEnter:"&"}}}])}(),function(){var a="windows",b=["AAPL","MSFT","TITN","SNDK","TSLA"],c=5,d=function(){function b(a,c,d){_classCallCheck(this,b),this.$rootScope=a,this.storage=c,this.store=d}return _createClass(b,[{key:"save",value:function(){localStorage.setItem(a,JSON.stringify(this.storage))}},{key:"update",value:function(a){this.save(),this.$rootScope.$broadcast("updateFavourites",a)}},{key:"get",value:function(){return this.store.stocks}},{key:"reorder",value:function(a,b){if(a!==b){var c=this.store.stocks,d=c.indexOf(a),e=c.indexOf(b);c.splice(e,0,c.splice(d,1)[0]),this.update()}}},{key:"add",value:function(a){var b=a.code;-1===this.store.stocks.indexOf(b)&&(this.store.stocks.push(b),this.update(a))}},{key:"remove",value:function(a){var b=a.code,c=this.store.stocks.indexOf(b);c>-1&&this.store.stocks.splice(c,1),this.update(a)}},{key:"closeWindow",value:function(){this.store.closed=Date.now(),this.save();var a=this.storage.filter(function(a){return 0!==a.closed});if(a.length>c){a.sort(function(a,b){return b.closed-a.closed});for(var b=c,d=a.length;d>b;b++){var e=this.storage.indexOf(a[b]);this.storage.splice(e,1)}}this.save()}}]),b}(),e=function(){function c(b){_classCallCheck(this,c),this.$rootScope=b,this.storage=JSON.parse(localStorage.getItem(a))}return _createClass(c,[{key:"getPreviousOpenWindowNames",value:function(){return(this.storage||[]).filter(function(a){return 0===a.closed}).map(function(a){return a.id})}},{key:"open",value:function(a){var c,e=(this.storage||[]).map(function(a){return a.id}).indexOf(a);if(e>-1)c=this.storage[e];else{var f=[];this.storage||(f=b,this.storage=[]);var g={id:a,stocks:f,closed:0};this.storage.push(g),c=g}return new d(this.$rootScope,this.storage,c)}}]),c}();e.$inject=["$rootScope"],angular.module("openfin.store").service("storeService",e)}(),function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.$timeout=b,this.currentWindowService=c,this.maximised=!1,this.compact=!1,c.ready(this.onReady.bind(this))}return _createClass(a,[{key:"onReady",value:function(){var a=this;this.window=this.currentWindowService.getCurrentWindow(),this.window.getBounds(function(b){a.compact=a.currentWindowService.compact=230===b.width}),this.window.addEventListener("maximized",function(){a.$timeout(function(){a.maximised=!0}),a.window.addEventListener("restored",function(a){this.$timeout(function(){this.maximised=!1})})}),this.window.addEventListener("bounds-changed",function(b){a.window.getBounds(function(b){a.currentWindowService.compact=230===b.width})})}},{key:"minimiseClick",value:function(){this.window.minimize()}},{key:"maximiseClick",value:function(){this.window.maximize()}},{key:"normalSizeClick",value:function(){this.window.restore(),this.window.resizeTo(1280,720,"top-right")}},{key:"compactClick",value:function(){this.compact=!this.compact,this.currentWindowService.compact=this.compact,this.compact?this.window.resizeTo(230,500,"top-right"):this.maximised?this.window.maximize():this.window.resizeTo(1280,720,"top-right")}},{key:"closeClick",value:function(){this.window.close()}}]),a}();a.$inject=["$timeout","currentWindowService"],angular.module("openfin.toolbar").controller("ToolbarCtrl",a)}(),function(){angular.module("openfin.toolbar").directive("toolbar",[function(){return{restrict:"E",templateUrl:"toolbar/toolbar.html",controller:"ToolbarCtrl",controllerAs:"toolbarCtrl"}}])}(),function(a){function b(){return"window"+Math.floor(1e3*Math.random())+Math.ceil(999*Math.random())}var c=function(){function a(){_classCallCheck(this,a),this.windowsOpen=0}return _createClass(a,[{key:"increment",value:function(){this.windowsOpen++}},{key:"decrement",value:function(){this.windowsOpen--,0===this.windowsOpen&&window.close()}},{key:"count",value:function(){return this.windowsOpen}}]),a}(),d=function(){function d(a){_classCallCheck(this,d),this.storeService=a,this.openWindows={},this.windowsCache=[],this.firstName=!0,this.apps=new c}return _createClass(d,[{key:"_createWindow",value:function(c,d,e){var f=this;c.name||(c.name=b());var g=new a.desktop.Window(c,function(){f.windowsCache.push(g),d&&d(g)});return this.apps.increment(),g.addEventListener("closed",function(a){var b=f.openWindows[g.name];if(b)for(var c=0,d=b.length;d>c;c++)b[c].close();var h=f.windowsCache.indexOf(g);f.windowsCache.slice(h,1),e&&e(),f.apps.decrement()}),g}},{key:"createMainWindow",value:function(a,b){var c=this;this._createWindow(a,function(a){a.getNativeWindow().windowService=c,a.getNativeWindow().storeService=c.storeService,b&&b(a),a.show()},function(){1!==c.apps.count()&&c.storeService.open(a.name).closeWindow()})}},{key:"createTearoutWindow",value:function(a,b){var c=this._createWindow(a);return this.openWindows[b]?this.openWindows[b].push(c):this.openWindows[b]=[].concat(c),c}},{key:"ready",value:function(b){a.desktop.main(b)}},{key:"getWindows",value:function(){return this.windowsCache}}]),d}();d.$inject=["storeService"],angular.module("openfin.window").service("windowCreationService",d)}(fin);