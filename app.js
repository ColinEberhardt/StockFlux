"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){angular.module("OpenFinD3FC",["ngAnimate","openfin.main","openfin.showcase","openfin.toolbar","openfin.icon","openfin.search","openfin.favourites","openfin.sidebar","openfin.filters","openfin.star","openfin.tearout","openfin.minichart","openfin.scroll","openfin.closedWindows","openfin.closedCard","openfin.config","openfin.version"]),angular.module("openfin.main",[]),angular.module("openfin.showcase",["openfin.selection","openfin.quandl"]),angular.module("openfin.toolbar",["openfin.currentWindow"]),angular.module("openfin.icon",[]),angular.module("openfin.search",["openfin.quandl","openfin.selection","openfin.currentWindow"]),angular.module("openfin.favourites",["openfin.quandl","openfin.selection","openfin.currentWindow"]),angular.module("openfin.sidebar",[]),angular.module("openfin.filters",[]),angular.module("openfin.star",["openfin.selection"]),angular.module("openfin.tearout",["openfin.geometry","openfin.hover","openfin.currentWindow","openfin.config"]),angular.module("openfin.minichart",["openfin.quandl"]),angular.module("openfin.store",[]),angular.module("openfin.currentWindow",[]),angular.module("openfin.scroll",[]),angular.module("openfin.closedWindows",[]),angular.module("openfin.closedCard",[]),angular.module("openfin.config",[]),angular.module("openfin.version",["openfin.currentWindow"])}(),function(){var a=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"openClosedWindow",value:function(a){var b=window.storeService.open(a);window.windowService.createMainWindow(a,b.isCompact())}}]),a}();a.$inject=[],angular.module("openfin.closedCard").controller("ClosedCardCtrl",a)}(),function(){angular.module("openfin.closedCard").directive("closedCard",[function(){return{restrict:"E",templateUrl:"closedWindows/closedCard.html",scope:{cardWindow:"="},controller:"ClosedCardCtrl",controllerAs:"closedCardCtrl"}}])}(),function(){var a=function(){function a(){_classCallCheck(this,a),this.closedWindows=[],this.closedTabsShow=!1}return _createClass(a,[{key:"refreshClosedWindows",value:function(){this.closedWindows=window.storeService.getPreviousClosedWindows()}},{key:"click",value:function(){this.refreshClosedWindows(),this.closedTabsShow=this.closedWindows.length>0}}]),a}();a.$inject=[],angular.module("openfin.closedWindows").controller("ClosedWindowsCtrl",a)}(),function(){var a=5e4,b=function(){function b(){_classCallCheck(this,b)}return _createClass(b,[{key:"createName",value:function(){return"window"+Math.floor(1e3*Math.random())+Math.ceil(999*Math.random())}},{key:"getWindowConfig",value:function(b){return{name:b||this.createName(),autoShow:!1,frame:!1,showTaskbarIcon:!0,saveWindowState:!0,url:"index.html",resizable:!0,maximizable:!0,minWidth:918,minHeight:510,maxWidth:a,maxHeight:a,defaultWidth:1280,defaultHeight:720}}},{key:"getCompactConfig",value:function(a){return{name:a||this.createName(),autoShow:!1,frame:!1,showTaskbarIcon:!0,saveWindowState:!0,url:"index.html",resizable:!1,maximizable:!1,minWidth:230,minHeight:500,maxWidth:230,maxHeight:500,defaultWidth:230,defaultHeight:500}}},{key:"getTearoutConfig",value:function(a){return{name:a||this.createName(),autoShow:!1,frame:!1,maximizable:!1,resizable:!1,showTaskbarIcon:!1,saveWindowState:!1,maxWidth:230,maxHeight:100,url:"tearout.html"}}},{key:"getTopCardOffset",value:function(){return[268,65]}}]),b}();b.$inject=[],angular.module("openfin.config").service("configService",b)}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.$scope=b,this.setup()}return _createClass(a,[{key:"setup",value:function(){function a(a){return arguments.length?void(d[c+e]=a):d[c+e]}function b(a){return arguments.length?void(d[c+f]=a):d[c+f]}var c=this.$scope.name,d={},e="_active",f="_hovered";d[c+e]=!1,d[c+f]=!1,this.urls={inactive:c,hover:c+"_hover",active:c+"_active"},this.icon={active:a,hovered:b}}},{key:"enter",value:function(){this.icon.hovered(!0)}},{key:"leave",value:function(){this.icon.hovered(!1),this.icon.active(!1)}},{key:"url",value:function(){return this.icon.active()?this.urls.active:this.icon.hovered()?this.urls.hover:this.urls.inactive}},{key:"mouseDown",value:function(a,b){0===a.button&&this.icon.active(!0)}},{key:"click",value:function(a,b){0===a.button&&(this.icon.active(!0),this.$scope.iconClick(),this.icon.active(!1),this.icon.hovered(!1))}}]),a}();a.$inject=["$scope"],angular.module("openfin.icon").controller("IconCtrl",a)}(),function(){angular.module("openfin.icon").directive("icon",[function(){return{restrict:"E",templateUrl:"icon/icon.html",scope:{name:"@",iconClick:"&"},controller:"IconCtrl",controllerAs:"iconCtrl"}}])}(),function(){var a=function(){function a(){_classCallCheck(this,a),this.store=null}return _createClass(a,[{key:"isCompact",value:function(){return!this.store&&window.storeService&&(this.store=window.storeService.open(window.name)),this.store&&this.store.isCompact()}}]),a}();a.$inject=[],angular.module("openfin.main").controller("MainCtrl",a)}(),function(){angular.module("openfin.main").directive("main",[function(){return{restrict:"E",templateUrl:"main/main.html",controller:"MainCtrl",controllerAs:"mainCtrl"}}])}(),function(){var a={version:"8.0.0"},b=function(){function b(a){_classCallCheck(this,b),this.currentWindowService=a}return _createClass(b,[{key:"version",value:function(){return a.version}},{key:"openGithub",value:function(){this.currentWindowService.openUrlWithBrowser("https://github.com/ScottLogic/stockflux")}}]),b}();b.$inject=["currentWindowService"],angular.module("openfin.version").controller("VersionCtrl",b)}(),function(){angular.module("openfin.version").directive("version",[function(){return{restrict:"E",templateUrl:"main/version/version.html",controller:"VersionCtrl",controllerAs:"versionCtrl"}}])}(),function(a){angular.module("openfin.currentWindow").factory("currentWindowService",["$rootScope",function(b){function c(){return a.desktop.Window.getCurrent()}function d(b){a.desktop.main(b)}function e(b){d(function(){a.desktop.System.openUrlWithBrowser(b)})}return window.addEventListener("updateFavourites",function(a){b.$broadcast("updateFavourites",a.stock)}),{getCurrentWindow:c,openUrlWithBrowser:e,ready:d}}])}(fin),function(){function a(){return moment().subtract(28,"days")}function b(a,b,c){var d=a.dataset_code,e={name:a.name,code:d,favourite:!1,query:b};c(e)}function c(b){for(var c=b.datasets,d=[],e=0,f=c.length;f>e;e++)moment(c[e].newest_available_date)>a()&&d.push(c[e]);return{datasets:d}}function d(a){var b=a.dataset,c=b.data,d=[],f=0,g=c.length;for(f;g>f;f++)d.push(e(c[f]));a.stockData={startDate:b.start_date,endDate:b.end_date,data:d}}function e(a){return{date:a[h],open:a[i],high:a[j],low:a[k],close:a[l],volume:a[m]}}var f="kM9Z9aEULVDD7svZ4A8B",g="api_key="+f,h=0,i=1,j=2,k=3,l=4,m=5,n="https://www.quandl.com/api/v3/",o="datasets/WIKI/",p=function(){function e(a){_classCallCheck(this,e),this.$resource=a}return _createClass(e,[{key:"search",value:function(a,c,d){this.stockSearch().get({query:a},function(e){e.datasets.map(function(d){b(d,a,c)}),0===e.datasets.length&&d()})}},{key:"getMeta",value:function(a,c){this.stockMetadata().get({stock_code:a},function(d){b(d.dataset,a,c)})}},{key:"stockData",value:function(){var b,c=a().format("YYYY-MM-DD");return this.$resource(n+o+":code.json?"+g+"&start_date="+c,{},{get:{method:"GET",transformResponse:function(a,c){return b=angular.fromJson(a),d(b),b},cache:!0}})}},{key:"getData",value:function(a,b){return this.stockData().get({code:a},function(c){var d={name:c.dataset.name,code:a,data:c.stockData.data};b(d)})}},{key:"stockMetadata",value:function(){return this.$resource(n+o+":stock_code/metadata.json?"+g,{},{get:{method:"GET",cache:!0}})}},{key:"stockSearch",value:function(){return this.$resource(n+"datasets.json?"+g+"&query=:query&database_code=WIKI",{},{get:{method:"GET",cache:!0,transformResponse:function(a,b){var d=angular.fromJson(a);return c(d)}}})}},{key:"apiKey",value:function(){return f}}]),e}();p.$inject=["$resource"],angular.module("openfin.quandl",["ngResource"]).service("quandlService",p)}(),function(){var a={code:"",name:""},b=function(){function b(){_classCallCheck(this,b),this._stock=a}return _createClass(b,[{key:"select",value:function(a){this._stock=a}},{key:"selectedStock",value:function(){return this._stock}},{key:"deselect",value:function(){this._stock=a}},{key:"hasSelection",value:function(){return this._stock!==a}}]),b}();b.$inject=[],angular.module("openfin.selection",[]).service("selectionService",b)}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.selectionService=b}return _createClass(a,[{key:"selectionCode",value:function(){return this.selectionService.selectedStock().code}},{key:"selectionName",value:function(){return this.selectionService.selectedStock().name}},{key:"hasSelection",value:function(){return this.selectionService.hasSelection()}}]),a}();a.$inject=["selectionService"],angular.module("openfin.showcase",["openfin.selection","openfin.quandl"]).controller("ShowcaseCtrl",a)}(),function(a){angular.module("openfin.showcase").directive("showcase",["quandlService",function(b){return{restrict:"E",templateUrl:"showcase/showcase.html",scope:{selection:"&"},link:function(c,d){var e=a.app().periodsOfDataToFetch(1200).quandlApiKey(b.apiKey()),f=!0;c.$watch("selection()",function(a,b){""!==a&&(f&&(f=!1,e.run(d[0].children[0])),a!==b&&e.changeQuandlProduct(a))})}}}])}(bitflux),function(){var a={up:"arrow_up",down:"arrow_down"},b=function(){function b(a,c,d,e,f){_classCallCheck(this,b),this.currentWindowService=a,this.quandlService=c,this.selectionService=d,this.$scope=e,this.$timeout=f,this.store=null,this.stocks=[],this.update(),this._watch()}return _createClass(b,[{key:"icon",value:function(b){return b.delta<0?a.down:a.up}},{key:"selection",value:function(){return this.selectionService.selectedStock().code}},{key:"select",value:function(a){this.selectionService.select(a)}},{key:"singleClick",value:function(a){window.storeService.open(window.name).isCompact()||this.select(a)}},{key:"doubleClick",value:function(a){var b=window.storeService.open(window.name);b.isCompact()&&(this.select(a),b.toggleCompact())}},{key:"noFavourites",value:function(){return 0===this.stocks.length}},{key:"single",value:function(){return 1===this.stocks.length?"single":""}},{key:"update",value:function(a){var b=this;this.currentWindowService.ready(function(){if(window.storeService){b.store||(b.store=window.storeService.open(window.name)),b.favourites=b.store.get();var c,d,e;for(c=0,d=b.stocks.length;d>c;c++){var f=b.stocks[c];f.index=b.stockSortFunction(f)}var g=[];for(c=0,d=b.stocks.length;d>c;c++)-1===b.favourites.indexOf(b.stocks[c].code)&&g.push(c);for(c=g.length-1,e=0;c>=e;c--)b.stocks.splice(g[c],1);var h=b.selectionService.selectedStock();if(a)if(0===b.stocks.length)a.favourite?b.selectionService.select(a):h.code===a.code&&b.selectionService.deselect();else if(h.code===a.code&&(!a.favourite||-1===b.favourites.indexOf(h.code))&&b.stocks.length>0){var i=b.stocks.filter(function(a){return a.code===b.favourites[0]})[0];b.selectionService.select(i)}b.favourites.map(function(a){-1===b.stocks.map(function(a){return a.code}).indexOf(a)&&b.quandlService.getData(a,function(c){if(-1===b.stocks.map(function(a){return a.code}).indexOf(a)){var d,e,f,g=c.data[0];g&&(d=g.close,e=g.close-g.open,f=e/g.open*100,b.stocks.push({name:c.name,code:c.code,price:d,delta:e,percentage:Math.abs(f),favourite:!0,index:b.stockSortFunction(c)}))}})})}})}},{key:"stockSortFunction",value:function(a){return this.favourites.indexOf(a.code)}},{key:"_watch",value:function(){var a=this;this.$scope.$on("updateFavourites",function(b,c){a.$timeout(function(){a.update(c)})})}}]),b}();b.$inject=["currentWindowService","quandlService","selectionService","$scope","$timeout"],angular.module("openfin.favourites").controller("FavouritesCtrl",b)}(),function(){angular.module("openfin.favourites").directive("favourite",[function(){return{restrict:"E",templateUrl:"sidebars/favourites/favourite.html",scope:{stock:"=",selection:"&",select:"&",singleClick:"&",doubleClick:"&",icon:"&",single:"&"}}}])}(),function(){function a(a){return{height:a.outerHeight,width:a.outerWidth,top:a.screenY,left:a.screenX}}function b(a,b){var c=b.getBoundingClientRect();return{height:c.height,width:c.width,top:a.top+c.top,left:a.left+c.left}}function c(a,b){var c=new e(a),d=new e(b);return c.intersects(d)}var d=function g(a,b){_classCallCheck(this,g),this.x=a||0,this.y=b||0},e=function(){function a(b){_classCallCheck(this,a),this.origin=new d(b.left,b.top),this.extent=new d(b.width,b.height)}return _createClass(a,[{key:"top",value:function(){return this.origin.y}},{key:"left",value:function(){return this.origin.x}},{key:"bottom",value:function(){return this.top()+this.extent.y}},{key:"right",value:function(){return this.left()+this.extent.x}},{key:"corner",value:function(){return new d(this.right(),this.bottom())}},{key:"intersects",value:function(a){var b=a.origin,c=a.corner();return c.x>this.origin.x&&c.y>this.origin.y&&b.x<this.corner().x&&b.y<this.corner().y}}]),a}(),f=function(){function d(){_classCallCheck(this,d)}return _createClass(d,[{key:"windowsIntersect",value:function(b,d){var e=b.getNativeWindow();return c(a(e),a(d))}},{key:"elementIntersect",value:function(d,e,f){var g=d.getNativeWindow();return c(a(g),b(a(e),f))}}]),d}();angular.module("openfin.geometry",[]).service("geometryService",f)}(),function(){var a=function(){function a(b){_classCallCheck(this,a),this.$rootScope=b,this.hoverTargets=[]}return _createClass(a,[{key:"get",value:function(){return this.hoverTargets}},{key:"add",value:function(a,b){var c={hoverArea:a,code:b};-1===this.hoverTargets.indexOf(c)&&this.hoverTargets.push(c)}},{key:"remove",value:function(a){for(var b=0,c=this.hoverTargets.length;c>b;b++)if(this.hoverTargets[b].code===a){this.hoverTargets.splice(b,1);break}}}]),a}();a.$inject=["$rootScope"],angular.module("openfin.hover",[]).service("hoverService",a)}(),function(){var a=function(){function a(b,c){_classCallCheck(this,a),this.quandlService=b,this.$timeout=c}return _createClass(a,[{key:"renderChart",value:function(a){var b=this;this.$timeout(function(){b.quandlService.getData(a.code,function(a){var b=fc.util.innerDimensions(document.getElementById(a.code+"chart")),c=b.width,d=b.height,e=a.data;e=e.map(function(a){var b=moment(a.date);return a.date=b.toDate(),a});var f=d3.select("#"+a.code+"chart").insert("svg","div").attr("width",c).attr("height",d),g=fc.scale.dateTime().domain(fc.util.extent().fields("date")(e)).discontinuityProvider(fc.scale.discontinuity.skipWeekends()).range([0,c]),h=fc.util.extent().fields(["close"])(e),i=d3.scale.linear().domain(h).range([d,0]).nice(),j=fc.series.area().y0Value(function(a){return h[0]}).y1Value(function(a){return a.close}).decorate(function(b){b.attr("fill","url(#"+a.code+"-minichart-gradient)")}),k=fc.series.line(),l=[].concat(e.slice(0)[0]),m=fc.series.point(),n=fc.series.multi().series([j,k,m]).xScale(g).yScale(i).mapping(function(a){switch(a){case m:return l;default:return e}});f.append("g").datum(e).call(n)})})}}]),a}();a.$inject=["quandlService","$timeout"],angular.module("openfin.minichart",["openfin.quandl"]).controller("MinichartCtrl",a)}(),function(){angular.module("openfin.minichart").directive("minichart",[function(){return{restrict:"E",templateUrl:"sidebars/favourites/minichart/minichart.html",scope:{renderChart:"&",stock:"="}}}])}(),function(a){angular.module("openfin.tearout").directive("tearable",["geometryService","hoverService","currentWindowService","configService",function(b,c,d,e){return{restrict:"C",link:function(f,g,h){function i(a,b){F.x=a,F.y=b}function j(a){G=a}function k(a,b){var c=5,d=5,e=16;B.moveTo(a-z+(e-F.x+d),b-(c+F.y))}function l(){B.show(),B.setAsForeground()}function m(a,b){b.contentWindow.document.body.appendChild(a)}function n(){C.appendChild(y),B.hide()}function o(){var a=B.getNativeWindow().document;a.body=a.createElement("body")}function p(a){return 0!==a.button?!1:x.classList.contains("single")?!1:(w=A.registerDrag(B,d.getCurrentWindow()),j(!0),i(a.offsetX,a.offsetY),k(a.screenX,a.screenY),o(),m(y,B),void l())}function q(a){G&&k(a.screenX,a.screenY)}function r(b){return 0!==b.button?!1:void(G&&(j(!1),H?n():(v||(v=a.storeService.open(a.name)),w.overAnotherInstance(function(c){if(c)w.moveToOtherInstance(f.stock),v.remove(f.stock),w=null;else{var d=v.isCompact();A.createMainWindow(null,d,function(c){c.resizeTo(a.outerWidth,a.outerHeight,"top-left");var g=e.getTopCardOffset();c.moveTo(b.screenX-g[0],b.screenY-g[1]);var h=a.storeService.open(c.name);h.add(f.stock),h.toggleCompact(d)})}D.removeChild(E),D.removeChild(C),u(),B.close()}))))}function s(){for(var d=c.get(),e=0,g=d.length;g>e;e++){var h=b.elementIntersect(B,a,d[e].hoverArea);if(h){v||(v=a.storeService.open(a.name)),v.reorder(f.stock.code,d[e].code);break}}}function t(){H=b.elementIntersect(B,a,document.getElementsByClassName("favourites")[0]),H&&s()}function u(){c.remove(f.stock.code),B.removeEventListener("bounds-changing",t),x.removeEventListener("mousedown",p),document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",r)}var v,w,x=g[0],y=x.parentNode.parentNode,z=y.clientWidth||230,A=(y.clientHeight||100,a.windowService),B=A.createTearoutWindow(a.name),C=y.parentNode,D=C.parentNode,E=D.getElementsByClassName("hover-area")[0],F={x:0,y:0},G=!1,H=!0;c.add(E,f.stock.code),B.addEventListener("bounds-changing",t),x.addEventListener("mousedown",p),document.addEventListener("mousemove",q,!0),document.addEventListener("mouseup",r,!0),f.$on("$destroy",function(){u()})}}}])}(window),function(){angular.module("openfin.filters").filter("truncate",function(){return function(a){if(a){var b=a.indexOf("(");return a.slice(0,b-1)}}})}(),function(){angular.module("openfin.scroll").directive("customScrollbar",[function(){return{restrict:"C",link:function(a,b){var c="scrollPadding";b.mCustomScrollbar({scrollInertia:0,mouseWheel:{scrollAmount:80},callbacks:{onOverflowY:function(){b.addClass(c)},onOverflowYNone:function(){b.removeClass(c)}}})}}}])}(),function(){var a=function(){function a(b,c,d,e){_classCallCheck(this,a),this.$scope=b,this.quandlService=c,this.selectionService=d,this.currentWindowService=e,this.store=null,this.query="",this.noResults=!1,this.stocks=[],this._watch()}return _createClass(a,[{key:"selection",value:function(){return this.selectionService.selectedStock().code}},{key:"select",value:function(a){this.selectionService.select(a)}},{key:"onSearchKeyDown",value:function(a){38===a.keyCode?this.changePointer(-1):40===a.keyCode?this.changePointer(1):27===a.keyCode&&this.$scope.sidebarCtrl.favouritesClick()}},{key:"changePointer",value:function(a){var b=this.stocks.map(function(a){return a.code}).indexOf(this.selection()),c=b+a;c=Math.max(0,Math.min(c,this.stocks.length-1)),this.stocks.length>0&&this.select(this.stocks[c])}},{key:"submit",value:function(){var a=this;this.stocks=[],this.noResults=!1,this.currentWindowService.ready(function(){a.store||(a.store=window.storeService.open(window.name));var b=a.store.get();if(a.query){var c=b.length;a.quandlService.search(a.query,function(d){var e;if(a.stocks=a.stocks.filter(function(b,c){return b.query===a.query}),d.query===a.query){a.noResults=!1;var f=!1;for(e=0;c>e;e++)d.code===b[e]&&(d.favourite=!0,a.stocks.unshift(d),f=!0);f||a.stocks.push(d)}},function(){return a.noResults=!0})}else b.map(function(b){a.quandlService.getMeta(b,function(b){b.favourite=!0,a.stocks.push(b)})})})}},{key:"_watch",value:function(){var a=this;this.$scope.$watch(function(){return a.query},function(){a.submit()}),this.$scope.$on("updateFavourites",function(b,c){if(c){var d=a.stocks.map(function(a){return a.code}).indexOf(c.code);d>-1?a.query?a.stocks[d].favourite=c.favourite:a.stocks.splice(d,1):c.favourite&&a.stocks.push(c)}})}}]),a}();a.$inject=["$scope","quandlService","selectionService","currentWindowService"],angular.module("openfin.search").controller("SearchCtrl",a)}(),function(){angular.module("openfin.search").directive("search",["$timeout",function(a){return{restrict:"E",templateUrl:"sidebars/search/search.html",controller:"SearchCtrl",controllerAs:"searchCtrl",link:function(b,c){c.on("click",function(){a(function(){c.find("input.sidetab").focus()},100)})}}}])}(),function(){var a={expanded:"expanded",contracted:"contracted"},b=function(){function b(){_classCallCheck(this,b),this._favouritesClass=a.expanded,this._searchClass=a.contracted,this._showSearches=!1,this._showFavourites=!0,this._searchSmall=!0}return _createClass(b,[{key:"searchClass",value:function(){return this._searchClass}},{key:"favouritesClass",value:function(){return this._favouritesClass}},{key:"showSearches",value:function(){return this._showSearches}},{key:"showFavourites",value:function(){return this._showFavourites}},{key:"searchClick",value:function(){this._searchSmall&&(this._searchSmall=!1,this._showFavourites=!1,this._searchClass=a.expanded,this._favouritesClass=a.contracted,this._showSearches=!0)}},{key:"favouritesClick",value:function(){this._searchSmall||(this._searchSmall=!0,this._searchClass=a.contracted,this._favouritesClass=a.expanded,this._showSearches=!1,this._showFavourites=!0)}}]),b}();b.$inject=[],angular.module("openfin.sidebar").controller("SidebarCtrl",b)}(),function(){angular.module("openfin.sidebar").directive("sideBar",[function(){return{restrict:"E",templateUrl:"sidebars/sidebar.html",controller:"SidebarCtrl",controllerAs:"sidebarCtrl"}}])}(),function(){var a={off:"favourite_OFF",on:"favourite_ON",offHover:"favourite_OFF_hover",onHover:"favourite_hover"},b=function(){function b(a,c){_classCallCheck(this,b),this.$scope=a,this.store=null,this.selectionService=c,this.starHovered=!1,this.check=!1}return _createClass(b,[{key:"favouriteUrl",value:function(b){return b.favourite?a.on:this.starHovered?a.onHover:b.isHovered||this.selectionService.selectedStock()===b?a.offHover:a.off}},{key:"click",value:function(a){this.check&&!confirm("Are you sure you wish to remove this stock ("+a.code+") from your favourites?")||(this.store||(this.store=window.storeService.open(window.name)),a.favourite?(a.favourite=!1,this.store.remove(a)):(a.favourite=!0,this.store.add(a)))}},{key:"mouseEnter",value:function(){this.starHovered=!0}},{key:"mouseLeave",value:function(){this.starHovered=!1}}]),b}();b.$inject=["$scope","selectionService"],angular.module("openfin.star").controller("StarCtrl",b)}(),function(){angular.module("openfin.star").directive("star",[function(){return{restrict:"E",templateUrl:"sidebars/star/star.html",scope:{starClick:"&",favouriteUrl:"&",mouseLeave:"&",mouseEnter:"&"}}}])}(),function(){var a,b="windows",c=["AAPL","MSFT","TITN","SNDK","TSLA"],d=5,e=function(){function c(a,b,d){_classCallCheck(this,c),this.$rootScope=a,this.store=b,this.windowName=d}return _createClass(c,[{key:"save",value:function(){localStorage.setItem(b,JSON.stringify(a))}},{key:"update",value:function(a){this.save(),this.$rootScope.$broadcast("updateFavourites",a,this.windowName)}},{key:"get",value:function(){return this.store.stocks}},{key:"reorder",value:function(a,b){if(a!==b){var c=this.store.stocks,d=c.indexOf(a),e=c.indexOf(b);c.splice(e,0,c.splice(d,1)[0]),this.update()}}},{key:"add",value:function(a){var b=a.code;-1===this.store.stocks.indexOf(b)&&(this.store.stocks.push(b),this.update(a))}},{key:"remove",value:function(a){var b=a.code,c=this.store.stocks.indexOf(b);c>-1&&this.store.stocks.splice(c,1),this.update(a)}},{key:"toggleCompact",value:function(a){this.store.compact=arguments.length?a:!this.store.compact,this.save()}},{key:"isCompact",value:function(){return this.store.compact}},{key:"openWindow",value:function(){this.store.closed=0,this.save()}},{key:"closeWindow",value:function(){this.store.closed=Date.now(),this.save();var b=a.filter(function(a){return 0!==a.closed});if(b.length>d){b.sort(function(a,b){return b.closed-a.closed});for(var c=d,e=b.length;e>c;c++){var f=a.indexOf(b[c]);a.splice(f,1)}}this.save()}}]),c}(),f=function(){function d(c){_classCallCheck(this,d),this.$rootScope=c,a=JSON.parse(localStorage.getItem(b))}return _createClass(d,[{key:"getPreviousOpenWindowNames",value:function(){return(a||[]).filter(function(a){return 0===a.closed}).map(function(a){return a.id})}},{key:"getPreviousClosedWindows",value:function(){return(a||[]).filter(function(a){return a.closed>0})}},{key:"open",value:function(b){var d,f=(a||[]).map(function(a){return a.id}).indexOf(b);if(f>-1)d=a[f];else{var g=[];a||(g=c,a=[]);var h={id:b,stocks:g,closed:0,compact:!1};a.push(h),d=h}return new e(this.$rootScope,d,b)}}]),d}();f.$inject=["$rootScope"],angular.module("openfin.store").service("storeService",f)}(),function(){var a=1280,b=720,c=230,d=500,e=function(){function e(a,b,c){var d=this;_classCallCheck(this,e),this.$scope=a,this.$timeout=b,this.currentWindowService=c,this.store=null,this.window=null,this.maximised=!1,this.oldSize=null,c.ready(function(){var a=d.onReady.bind(d);a(),d._watch()}),this.maximisedEvent=function(){d.$timeout(function(){d.maximised=!0})},this.restoredEvent=function(){d.$timeout(function(){d.maximised=!1})}}return _createClass(e,[{key:"isCompact",value:function(){return!this.store&&window.storeService&&(this.store=window.storeService.open(window.name)),this.store&&this.store.isCompact()}},{key:"onReady",value:function(){this.window=this.currentWindowService.getCurrentWindow(),this.window.addEventListener("maximized",this.maximisedEvent),this.window.addEventListener("restored",this.restoredEvent)}},{key:"minimiseClick",value:function(){this.window.minimize()}},{key:"maximiseClick",value:function(){this.window.maximize()}},{key:"normalSizeClick",value:function(){this.window.restore(),this.window.resizeTo(a,b,"top-right")}},{key:"_compactChanged",value:function(){var e=this.isCompact();if(e&&window.outerWidth!==c&&(this.oldSize=[window.outerWidth,window.outerHeight]),window.windowService.updateOptions(this.window,e),e)this.window.resizeTo(c,d,"top-right");else if(this.maximised)this.window.maximize();else{var f=a,g=b;this.oldSize&&(f=this.oldSize[0],g=this.oldSize[1]),this.window.resizeTo(f,g,"top-right")}}},{key:"compactClick",value:function(){this.store||(this.store=window.storeService.open(window.name)),this.store.toggleCompact()}},{key:"closeClick",value:function(){this.window.removeEventListener("maximized",this.maximisedEvent),this.window.removeEventListener("restored",this.restoredEvent),this.window.close()}},{key:"_watch",value:function(){var a=this;this.$scope.$watch(function(){return a.isCompact()},function(){return a._compactChanged()})}}]),e}();e.$inject=["$scope","$timeout","currentWindowService"],angular.module("openfin.toolbar").controller("ToolbarCtrl",e)}(),function(){angular.module("openfin.toolbar").directive("toolbar",[function(){return{restrict:"E",templateUrl:"toolbar/toolbar.html",controller:"ToolbarCtrl",controllerAs:"toolbarCtrl"}}])}();